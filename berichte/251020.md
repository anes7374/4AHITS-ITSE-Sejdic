
# Arbeitsbericht: Host Discovery

* **Klasse:** 4AHITS
* **Name:** Anes Sejdic
* **Fach:** ITSE
* **Datum:** 2025-10-20

---

## Inhaltsverzeichnis

1. [Ping](#1-ping)  
   1.1 [Ping Cheat Sheet](#11-ping-cheat-sheet)  
   1.2 [Netzwerkprotokoll und Firewall‑Probleme](#12-netzwerkprotokoll-und-firewall-probleme)
2. [Ping Skript zur automatisierten Host Discovery](#2-ping-skript-zur-automatisierten-host-discovery)
3. [Host Discovery mit nmap](#3-host-discovery-mit-nmap)
4. [Alternativen zur Host Discovery](#4-alternativen-zur-host-discovery)
5. [Verteidigung gegen Ping‑Scans](#5-verteidigung-gegen-pingscans)  
    5.1 [Verteidigungsmöglichkeiten](#51-verteidigungsmöglichkeiten)
    5.2 [Wie ein Angreifer das umgehen kann](#52-wie-ein-angreifer-das-umgehen-kann)

---

## 1. Ping

### 1.1 Ping Cheat Sheet

| Option | Beschreibung | Beispiel |
|--------|--------------|---------|
| `-c N` | Anzahl der Pings | `ping -c 1 <IP>` |
| `-W S` | Timeout in Sekunden | `ping -c 1 -W 1 <IP>` |
| `-q` | Nur Zusammenfassung anzeigen | `ping -q <IP>` |
| `-n` | Keine Namensauflösung | `ping -n <IP>` |
| `-s SIZE` | Paketgröße festlegen | `ping -s 1000 <IP>` |

### 1.2 Netzwerkprotokoll und Firewall-Probleme

**Protokoll:** ping verwendet ICMP (Echo Request / Echo Reply — ICMPv4 Typ 8/0).

**Firewall-Verhalten:** oft blocken sie ICMP-Echo, rate-limiting statt vollständigem Block, oder selektives Filtern bestimmter ICMP-Typen; manche erlauben nur Antworten auf ausgehende Requests

---

## 2. Ping Skript zur automatisierten Host Discovery

**Skript: `ping_script.sh`**

```bash
#!/usr/bin/env bash

if [[ -z "$1" ]]; then
  echo "Usage: $0 <network-prefix> (z.B. 192.168.178)"
  exit 1
fi

prefix="$1"

for i in $(seq 1 254); do
  ip="${prefix}.${i}"
  if ping -c 1 -W 1 -n "$ip" >/dev/null 2>&1; then
    echo "$ip is up"
  fi
done

echo "Scan abgeschlossen!"
```

Erklärung der Ping-Optionen:

* `-c 1` --> (ein Paket)
* `-W 1` --> 1s Timeout
* `-n` --> keine DNS‑Auflösung

**Ausführung:**

```bash
chmod +x ping_script.sh
./ping_script.sh 192.168.8
```

**Ausgabe:**

```bash
└─$ ./ping_script.sh 192.168.8
192.168.8.50 is up
192.168.8.51 is up
192.168.8.56 is up
192.168.8.254 is up
Scan abgeschlossen!
```

Hier sieht man:
* Hostadresse
* Kaliadresse
* Metasploitableadresse
* Default-Gateway

---

## 3. Host Discovery mit nmap

**Recherche:**  
Nmap ist ein Tool zur Netzwerkerkundung und Sicherheitsanalyse, das aktive Hosts, offene Ports, laufende Dienste und (häufig) Betriebssysteme im Netzwerk erkennt.

* `sn` — Host‑Discovery / Ping‑Sweep (keine Portscans)
* `sS` — TCP SYN‑Scan (schnell/„stealth“, meist root)
* `p <ports>` — Ports angeben (z. B. -p 22,80,443 oder -p- für alle)
* `sV` — Dienst‑/Versionserkennung (zeigt laufende Dienste und Versionen)

**Befehl:**

```bash
sudo nmap -sn 192.168.8.0/24
```

* `-sn` → Nur Host Discovery, kein Portscan

**Ausgabe:**

```bash
─(kali㉿kali)-[~]
└─$ sudo nmap -sn 192.168.8.0/24         
[sudo] password for kali: 
Starting Nmap 7.95 ( https://nmap.org ) at 2025-10-20 06:31 EDT
Nmap scan report for 192.168.8.50
Host is up (0.00057s latency).
MAC Address: 60:A4:B7:75:7A:7F (TP-Link Limited)
Nmap scan report for 192.168.8.51
Host is up (0.0014s latency).
MAC Address: 00:0C:29:7B:38:F0 (VMware)
Nmap scan report for 192.168.8.254
Host is up (0.00064s latency).
MAC Address: 1C:DF:0F:CA:41:01 (Cisco Systems)
Nmap scan report for 192.168.8.56
Host is up.
Nmap done: 256 IP addresses (4 hosts up) scanned in 2.38 seconds
```

**Ergebnis:**
Nmap fand dieselben aktiven Hosts wie das Ping‑Skript, jedoch schneller.

---

## 4. Alternativen zur Host Discovery

Falls `ping` oder `nmap` nicht verfügbar oder blockiert sind, können folgende Methoden genutzt werden:

* `arp-scan --localnet` — ARP‑Requests, sehr zuverlässig im LAN
* `fping -a -g <subnet>` — paralleler Ping‑Sweep
* `arping <IP>` — ARP‑basierter Ping für einzelne Hosts
* `netdiscover` — passive/aktive ARP‑Discovery
* `nc` / `netcat` — TCP‑Connect‑Tests auf bekannte Ports

---

## 5. Verteidigung gegen Ping‑Scans

### 5.1 Verteidigungsmöglichkeiten

* **ICMP (Ping) blockieren:** Die Firewall lässt eingehende Ping‑Anfragen nicht durch. Scanner sehen Hosts per Ping nicht mehr.
* **Rate‑Limit setzen:** Die Firewall begrenzt, wie viele Ping‑Antworten pro Sekunde erlaubt sind. Große Sweeps werden gebremst.
* **Nur Antworten auf eigene Anfragen erlauben (stateful):** Hosts dürfen nur auf Pings antworten, wenn sie selbst zuerst gepingt haben.
* **IDS/IPS einsetzen:** Systeme erkennen typische Ping‑Scan‑Muster und melden oder blockieren sie.
* **VLANs:** Teile das Netzwerk, damit Scanner nur eingeschränkten Zugang haben.

### 5.2 Wie ein Angreifer das umgehen kann

* **ARP‑Scan im lokalen LAN:** Wenn der Angreifer im gleichen Netz ist, findet er Hosts mit ARP, auch wenn Ping geblockt ist.
* **Andere Probes verwenden (TCP/UDP):** Statt ICMP kann der Angreifer zum Beispiel TCP‑SYN an Port 80 schicken, um zu testen, ob ein Host antwortet.
* **Passiv lauschen:** Mit `tcpdump` oder ähnlichem kann man DHCP/ARP/MDNS‑Traffic abhören und Geräte entdecken, ohne zu scannen.
